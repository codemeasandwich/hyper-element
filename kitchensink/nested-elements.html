<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Nested Elements - hyper-element Kitchen Sink</title>
  <script src="https://cdn.jsdelivr.net/npm/hyperhtml@latest/min.js"></script>
  <script src="test-loader.js"></script>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    section { margin: 2rem 0; padding: 1rem; border: 1px solid #ddd; border-radius: 4px; }
    section[data-test-result="pass"] { border-color: green; background: #f0fff0; }
    section[data-test-result="fail"] { border-color: red; background: #fff0f0; }
    h1 { border-bottom: 2px solid #333; }
    h2 { margin-top: 0; }
    pre { background: #f5f5f5; padding: 1rem; overflow-x: auto; }
  </style>
</head>
<body>
  <h1>Nested Elements</h1>
  <p>Demonstrates parent-child custom element composition with attribute passing.</p>

  <section data-test="nested-string-attrs" data-test-result="pending">
    <h2>Passing String Attributes</h2>
    <p>Parent elements can pass string attributes to child custom elements.</p>
    <pre><code>// Inner element
class extends hyperElement {
  render(Html) {
    Html`Inner: ${this.attrs.message}`
  }
}

// Outer element
class extends hyperElement {
  render(Html) {
    Html`Outer: &lt;inner-elem message=${"Hello"}&gt;&lt;/inner-elem&gt;`
  }
}</code></pre>
    <outter1-elem></outter1-elem>
    <script>
      customElements.define("inner1-elem", class extends hyperElement {
        render(Html) {
          Html`Inner: ${this.attrs.message || "missing"}`
        }
      });

      customElements.define("outter1-elem", class extends hyperElement {
        render(Html) {
          Html`Outer(<inner1-elem message=${"PASS"}></inner1-elem>)`
        }
      });

      requestAnimationFrame(() => {
        const section = document.querySelector('[data-test="nested-string-attrs"]');
        const outer = document.querySelector('outter1-elem');
        if (outer && outer.textContent.includes('PASS')) {
          section.dataset.testResult = 'pass';
        } else {
          section.dataset.testResult = 'fail';
        }
      });
    </script>
  </section>

  <section data-test="nested-function-attrs" data-test-result="pending">
    <h2>Passing Function References</h2>
    <p>Parent elements can pass function references to child elements.</p>
    <pre><code>// Inner element
class extends hyperElement {
  render(Html) {
    const fn = this.attrs.callback || (() => "missing")
    Html`Result: ${fn()}`
  }
}

// Outer element
class extends hyperElement {
  getValue() { return "PASS" }
  render(Html) {
    Html`&lt;inner-elem callback=${this.getValue}/&gt;`
  }
}</code></pre>
    <outter2-elem></outter2-elem>
    <script>
      customElements.define("inner2-elem", class extends hyperElement {
        render(Html) {
          const fn = this.attrs.callback || (() => "missing")
          Html`Result: ${fn()}`
        }
      });

      customElements.define("outter2-elem", class extends hyperElement {
        getValue() {
          return "PASS"
        }
        render(Html) {
          Html`Outer(<inner2-elem callback=${this.getValue}/>)`
        }
      });

      requestAnimationFrame(() => {
        const section = document.querySelector('[data-test="nested-function-attrs"]');
        const outer = document.querySelector('outter2-elem');
        if (outer && outer.textContent.includes('PASS')) {
          section.dataset.testResult = 'pass';
        } else {
          section.dataset.testResult = 'fail';
        }
      });
    </script>
  </section>

  <a href="index.html">&larr; Back to Kitchen Sink</a>
</body>
</html>
