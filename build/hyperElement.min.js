(function(d){window.hyperElement=d(window.hyperHTML)})(function(d){const b={},g={},w=/<+\w+[-]+\w/;function O(){for(var a="",e="bcdfghjklmnpqrstvwxyz",r=0;r<15;r++)a+=e.charAt(Math.floor(Math.random()*e.length));return a}function C(a,e){const r=typeof e=="function"?e:()=>e,n=this.render,o=(...s)=>{e===void 0?(a.store=void 0,n(...s)):(a.store=r(),n(a.store,...s))};return this.render=o,o}function j(a){const e=a.this;new MutationObserver(n=>{if(!a.observe)return;if(n.filter(t=>t.type==="attributes").length>0){e.attrs=this.attachAttrs(this.attributes)||{},this.render();return}let s=this.textContent;a.innerHTML=this.innerHTML,e.attrs.template&&(e.attrs=this.attachAttrs(this.attributes)||{}),d.bind(a.shadow)``,e.wrappedContent=s,this.render()}).observe(this,{attributes:!0,childList:!0,subtree:!0})}function x(a,e){let r=a;const n=/\{#each\s+(\w+)\}([\s\S]*?)\{\/each\}/g;r=r.replace(n,(i,c,l)=>{const p=e[c];return Array.isArray(p)?p.map((u,f)=>{let h=l;return h=h.replace(/\{\.\}/g,u),h=h.replace(/\{@index\}/g,f),typeof u=="object"&&u!==null&&Object.keys(u).forEach(m=>{h=h.replace(new RegExp("\\{"+m+"\\}","g"),u[m])}),h}).join(""):""});const o=/\{#if\s+(\w+)\}([\s\S]*?)\{else\}([\s\S]*?)\{\/if\}/g;r=r.replace(o,(i,c,l,p)=>e[c]?l:p);const s=/\{#if\s+(\w+)\}([\s\S]*?)\{\/if\}/g;r=r.replace(s,(i,c,l)=>e[c]?l:"");const t=/\{#unless\s+(\w+)\}([\s\S]*?)\{\/unless\}/g;return r=r.replace(t,(i,c,l)=>e[c]?"":l),r}function y(a){if(/\{#(if|each|unless)\s/.test(a))return function(t){if(typeof t!="object")throw new Error("Templates must be passed an object. You passed "+JSON.stringify(t));let i=x(a,t);return i=i.replace(/\{(\w+)\}/g,(c,l)=>t[l]!=null?t[l]:""),i};const r=/(\{[\w]+\})/g,n=a.split(r).reduce((s,t)=>(t[0]==="{"&&t.slice(-1)==="}"?s.keys.push(t.slice(1,-1)):s.markup.push(t),s),{markup:[],keys:[]});n.id=":"+n.markup.join().trim();function o(s,t){const i=[n.markup,...n.keys.map(c=>s[c])];return i.raw={value:n.markup},i}return function(t){if(typeof t!="object")throw new Error("Templates must be passed an object to be populated with. You passed "+JSON.stringify(t)+" to "+n.id);return d.wire(t,n.id)(...o(t))}}function A(a,e){if(a==="template"&&e==="")return!0;if(+e+""===e.trim())return+e;const r=e.toLowerCase().trim();return r==="true"?!0:r==="false"?!1:r[0]==="["&&r.slice(-1)==="]"||r[0]==="{"&&r.slice(-1)==="}"?JSON.parse(e):e}function v(){this.identifier=Symbol(this.localName);const a=b[this.identifier]={attrsToIgnore:{}};a.innerHTML=this.innerHTML;const e=a.this={element:this};e.wrappedContent=this.textContent,j.call(this,a),Object.getOwnPropertyNames(this.__proto__).filter(s=>!(s==="constructor"||s==="setup"||s==="render")).forEach(s=>{if(/^[A-Z]/.test(s)){let t;const i={},c=l=>{if(t!==void 0&&t.once)return t;if(t=this[s](l),t.template)if(typeof t.template=="string")i[t.template]||(i[t.template]=y(t.template)),t={any:i[t.template](t.values||l)};else if(typeof t.template=="object"&&typeof t.template.then=="function")t=Object.assign({},t,{any:t.template.then(p=>{let{template:u,values:f}=p;return!u&&typeof p=="string"&&(u=p,f={}),i[u]||(i[u]=y(u)),Array.isArray(f)?t={any:f.map(i[u]),once:t.once}:t={any:i[u](f||l),once:t.once},t.any})});else throw new Error("unknow template type:"+typeof t.template+" | "+JSON.stringify(t.template));return t};d.define(s,c)}else e[s]=this[s].bind(e);delete this[s]});function r(){return"hyper-element: "+this.localName}Object.defineProperty(e,"toString",{value:r.bind(this),writable:!1}),a.shadow=this;const n=d.bind(a.shadow);a.Html=function(...t){if(t.slice(1).some(i=>typeof i=="function"||i!==null&&typeof i=="object")&&t[0].some(i=>w.test(i))){let i=!1,c="";t[0].forEach((l,p,u)=>{if(w.test(l)?(i=l.substring(l.match(w).index).indexOf(">")===-1,c=i&&l.substring(l.indexOf(l.match(w))).split(" ")[0].substr(1)):0<=l.indexOf(">")&&(i=!1,c=""),!i)return;const f=t[p+1];if(typeof f=="function"||f!==null&&typeof f=="object"){const h=l.split(" ").pop().slice(0,-1);if(h.substring(0,2)==="on")throw new Error(`'on' is reserve for native elements. Change: "${h}" for "${c}" to something else`);if(h==="style")return;const m=O();g[m]={attrName:h,val:f,localName:c},t[p+1]=(typeof f=="function"?"fn-":"ob-")+m}})}return n(...t)},a.Html.wire=function(...t){return d.wire(...t)},a.Html.lite=function(...t){return d(...t)},e.attrs=this.attachAttrs(this.attributes),e.dataset=this.getDataset();const o=this.render;this.render=(...s)=>{a.observe=!1,setTimeout(()=>{a.observe=!0},0),o.call(e,a.Html,...s),Object.getOwnPropertyNames(e.dataset).filter(t=>!this.dataset[t]).forEach(t=>{const i=e.dataset[t];this.addDataset(e.dataset,t.replace(/([A-Z])/g,c=>`-${c[0].toLowerCase()}`)),e.dataset[t]=i})},this.setup&&(a.teardown=this.setup.call(e,C.bind(this,e))),this.render()}class N extends HTMLElement{get innerShadow(){return b[this.identifier].shadow.innerHTML}connectedCallback(){v.call(this)}addDataset(e,r){const n=r.replace(/-([a-z])/g,o=>o[1].toUpperCase());Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>A(n,this.dataset[n]),set:o=>{b[this.identifier].attrsToIgnore["data-"+r]=!0,typeof o=="string"?this.dataset[n]=o:this.dataset[n]=JSON.stringify(o)}})}getDataset(){const e={};return Object.keys(this.dataset).forEach(r=>this.addDataset(e,r.replace(/([A-Z])/g,n=>`-${n[0].toLowerCase()}`))),e}attachAttrs(e){const r={};for(let n=0;n<e.length;n++){const{value:o,name:s}=e[n];if(s==="template"&&!o){const t=b[this.identifier];t.Html.template=y(t.innerHTML),r[s]=!0}else(o.substr(0,3)==="fn-"||o.substr(0,3)==="ob-")&&g[o.substr(3)]&&g[o.substr(3)].localName===this.localName?r[s]=g[o.substr(3)].val:+o+""===(o+"").trim()?r[s]=+o:r[s]=o}return r}attributeChangedCallback(e,r,n){const o=b[this.identifier];if(!o)return;n!==null&&+n+""===n.trim()&&(n=+n);const{attrsToIgnore:s}=o,t=o.this;if(0<=e.indexOf("data-")){const i=e.slice(5);if(r===null)this.addDataset(t.dataset,i);else if(n===null){const c=i.replace(/-([a-z])/g,l=>l[1].toUpperCase());delete t.dataset[c]}}if(n!==t.attrs[e])if(n===null?delete t.attrs[e]:t.attrs[e]=n,s[e]){delete s[e];return}else this.render()}disconnectedCallback(){const e=b[this.identifier];e.teardown&&e.teardown()}}return N});
//# sourceMappingURL=hyperElement.min.js.map
