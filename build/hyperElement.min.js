(function(p){typeof exports=="object"?module.exports=p(require("hyperhtml/cjs")):typeof define=="function"&&define.amd?define(["hyperhtml"],p):window.hyperElement=p(window.hyperHTML)})(function(p){const b={},g={},N=/<\s*[a-z]+-[a-z][^>]*>/g,w=/<+\w+[-]+\w/;function j(){for(var o="",e="bcdfghjklmnpqrstvwxyz",r=0;r<15;r++)o+=e.charAt(Math.floor(Math.random()*e.length));return o}function x(o,e){const r=typeof e=="function"?e:()=>e,n=this.render,a=(...s)=>{e===void 0?(o.store=void 0,n(...s)):(o.store=r(),n(o.store,...s))};return this.render=a,a}function A(o){const e=o.this;new MutationObserver(n=>{if(!o.observe)return;if(n.filter(t=>t.type==="attributes").length>0){e.attrs=this.attachAttrs(this.attributes)||{},this.render();return}let s=this.textContent;o.innerHTML=this.innerHTML,e.attrs.template&&(e.attrs=this.attachAttrs(this.attributes)||{}),p.bind(o.shadow)``,e.wrappedContent=s,this.render()}).observe(this,{attributes:!0,childList:!0,subtree:!0})}function k(o,e){let r=o;const n=/\{#each\s+(\w+)\}([\s\S]*?)\{\/each\}/g;r=r.replace(n,(i,l,c)=>{const u=e[l];return Array.isArray(u)?u.map((f,d)=>{let h=c;return h=h.replace(/\{\.\}/g,f),h=h.replace(/\{@index\}/g,d),typeof f=="object"&&f!==null&&Object.keys(f).forEach(m=>{h=h.replace(new RegExp("\\{"+m+"\\}","g"),f[m])}),h}).join(""):""});const a=/\{#if\s+(\w+)\}([\s\S]*?)\{else\}([\s\S]*?)\{\/if\}/g;r=r.replace(a,(i,l,c,u)=>e[l]?c:u);const s=/\{#if\s+(\w+)\}([\s\S]*?)\{\/if\}/g;r=r.replace(s,(i,l,c)=>e[l]?c:"");const t=/\{#unless\s+(\w+)\}([\s\S]*?)\{\/unless\}/g;return r=r.replace(t,(i,l,c)=>e[l]?"":c),r}function y(o){if(/\{#(if|each|unless)\s/.test(o))return function(t){if(typeof t!="object")throw new Error("Templates must be passed an object. You passed "+JSON.stringify(t));let i=k(o,t);return i=i.replace(/\{(\w+)\}/g,(l,c)=>t[c]!=null?t[c]:""),i};const r=/(\{[\w]+\})/g,n=o.split(r).reduce((s,t)=>(t[0]==="{"&&t.slice(-1)==="}"?s.keys.push(t.slice(1,-1)):s.markup.push(t),s),{markup:[],keys:[]});n.id=":"+n.markup.join().trim();function a(s,t){const i=[n.markup,...n.keys.map(l=>s[l])];return i.raw={value:n.markup},i}return function(t){if(typeof t!="object")throw new Error("Templates must be passed an object to be populated with. You passed "+JSON.stringify(t)+" to "+n.id);return p.wire(t,n.id)(...a(t))}}function v(o,e){if(o==="template"&&e==="")return!0;if(+e+""===e.trim())return+e;const r=e.toLowerCase().trim();return r==="true"?!0:r==="false"?!1:r[0]==="["&&r.slice(-1)==="]"||r[0]==="{"&&r.slice(-1)==="}"?JSON.parse(e):e}function C(){this.identifier=Symbol(this.localName);const o=b[this.identifier]={attrsToIgnore:{}};o.innerHTML=this.innerHTML;const e=o.this={element:this};e.wrappedContent=this.textContent,A.call(this,o),Object.getOwnPropertyNames(this.__proto__).filter(s=>!(s==="constructor"||s==="setup"||s==="render")).forEach(s=>{if(/^[A-Z]/.test(s)){let t;const i={},l=c=>{if(t!==void 0&&t.once)return t;if(t=this[s](c),t.template)if(typeof t.template=="string")i[t.template]||(i[t.template]=y(t.template)),t={any:i[t.template](t.values||c)};else if(typeof t.template=="object"&&typeof t.template.then=="function")t=Object.assign({},t,{any:t.template.then(u=>{let{template:f,values:d}=u;return!f&&typeof u=="string"&&(f=u,d={}),i[f]||(i[f]=y(f)),Array.isArray(d)?t={any:d.map(i[f]),once:t.once}:t={any:i[f](d||c),once:t.once},t.any})});else throw new Error("unknow template type:"+typeof t.template+" | "+JSON.stringify(t.template));return t};p.define(s,l)}else e[s]=this[s].bind(e);delete this[s]});function r(){return"hyper-element: "+this.localName}Object.defineProperty(e,"toString",{value:r.bind(this),writable:!1}),o.shadow=this;const n=p.bind(o.shadow);if(o.Html=function(...t){if(t.slice(1).some(i=>typeof i=="function"||i!==null&&typeof i=="object")&&t[0].some(i=>w.test(i))){let i=!1,l="";const c=[];t[0].forEach((u,f,d)=>{if(w.test(u)?(i=u.substring(u.match(w).index).indexOf(">")===-1,l=i&&u.substring(u.indexOf(u.match(w))).split(" ")[0].substr(1)):0<=u.indexOf(">")&&(i=!1,l=""),!i)return;const h=t[f+1];if(typeof h=="function"||h!==null&&typeof h=="object"){const m=u.split(" ").pop().slice(0,-1);if(m.substring(0,2)==="on")throw new Error(`'on' is reserve for native elements. Change: "${m}" for "${l}" to something else`);if(m==="style")return;const O=j();g[O]={attrName:m,val:h,localName:l},t[f+1]=(typeof h=="function"?"fn-":"ob-")+O}})}return n(...t)},o.Html.wire=function(...t){return p.wire(...t)},o.Html.lite=function(...t){return p(...t)},this.attrs)throw new Error("'attrs' is defined!!");e.attrs=this.attachAttrs(this.attributes)||{},e.dataset=this.getDataset();const a=this.render;this.render=(...s)=>{o.observe=!1,setTimeout(()=>{o.observe=!0},0),a.call(e,o.Html,...s),Object.getOwnPropertyNames(e.dataset).filter(t=>!this.dataset[t]).forEach(t=>{const i=e.dataset[t];this.addDataset(e.dataset,t.replace(/([A-Z])/g,l=>`-${l[0].toLowerCase()}`)),e.dataset[t]=i})},this.setup&&(o.teardown=this.setup.call(e,x.bind(this,e))),this.render()}class E extends HTMLElement{get innerShadow(){return b[this.identifier].shadow.innerHTML}createdCallback(){C.call(this)}connectedCallback(){C.call(this)}addDataset(e,r){const n=r.replace(/-([a-z])/g,a=>a[1].toUpperCase());Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>v(n,this.dataset[n]),set:a=>{b[this.identifier].attrsToIgnore["data-"+r]=!0,typeof a=="string"?this.dataset[n]=a:this.dataset[n]=JSON.stringify(a)}})}getDataset(){const e={};return Object.keys(this.dataset).forEach(r=>this.addDataset(e,r.replace(/([A-Z])/g,n=>`-${n[0].toLowerCase()}`))),e}attachAttrs(e){const r={};for(let n=0;n<e.length;n++){const{value:a,name:s}=e[n];if(s==="template"&&!a){const t=b[this.identifier];t.Html.template=y(t.innerHTML),r[s]=!0}else(a.substr(0,3)==="fn-"||a.substr(0,3)==="ob-")&&g[a.substr(3)]&&g[a.substr(3)].localName===this.localName?r[s]=g[a.substr(3)].val:+a+""===(a+"").trim()?r[s]=+a:r[s]=a}return r}attributeChangedCallback(e,r,n){+n+""===n.trim()&&(n=+n);const a=b[this.identifier],{attrsToIgnore:s}=a,t=a.this;if(0<=e.indexOf("data-")){const i=e.slice(5);if(r===null)this.addDataset(t.dataset,i);else if(n===null){const l=i.replace(/-([a-z])/g,c=>c[1].toUpperCase());delete t.dataset[l]}}if(n!==t.attrs[e])if(n===null?delete t.attrs[e]:t.attrs[e]=n,s[e]){delete s[e];return}else this.render()}disconnectedCallback(){const e=b[this.identifier];e.teardown&&e.teardown()}}return E});
//# sourceMappingURL=hyperElement.min.js.map
